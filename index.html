<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />

  <!-- ‚úÖ –ó–∞–ø—Ä–µ—Ç –∑—É–º–∞ (best-effort). –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å ‚Äî —É–±–µ—Ä–∏ maximum-scale=1 –∏ user-scalable=no -->
  <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" />

  <title>NY Stories</title>

  <style>
    /* =====================================================================
       0) –ù–ê–°–¢–†–û–ô–ö–ò (–æ–±—ã—á–Ω–æ –ø—Ä–∞–≤–∏—à—å —Ç—É—Ç)
       ===================================================================== */
    :root{
      /* –¶–≤–µ—Ç–∞ */
      --blue:#2aa8ff;
      --blueDark:#0b63c9;
      --ink:#11324a;

      /* –¢—ë–º–Ω—ã–π —Ñ–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
      --bgDeep1:#06122e;
      --bgDeep2:#071a3a;

      /* –ì–µ–æ–º–µ—Ç—Ä–∏—è */
      --shellRadius: 32px;
      --cardRadius: 26px;
      --pad: 18px;
      --footerH: 22px;

      /* –ü—Ä–æ–≥—Ä–µ—Å—Å */
      --progressH: 4px;
      --progressGap: 6px;

      /* –ê–≤–∞—Ç–∞—Ä */
      --ringPad: 3px;
      --avatarSafeWhite: 0px;  /* ‚úÖ –±–µ–ª–∞—è —Å–µ–π—Ñ-–∑–æ–Ω–∞ 1px –ø–æ—Å–ª–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ */

      /* –ü–µ—Ä–µ–ª–∏–≤–∞—é—â–∞—è—Å—è —Ä–∞–º–∫–∞ (–∫–∞–∫ —É —Ç–µ–∫—Å—Ç–∞) */
      --borderW: 3px;
      --shimmerSpeed: 2.6s;

      /* –ú–µ–¥–∏–∞ (–∫–∞—Ä—Ç–∏–Ω–∫–∞ 1080√ó1920 –±–µ–∑ –æ–±—Ä–µ–∑–∫–∏) */
      --mediaSafe: 3px;
    }

    /* =====================================================================
       1) –ë–ê–ó–ê
       ===================================================================== */
    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
      overflow:hidden; /* ‚úÖ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ —Å–∫—Ä–æ–ª–ª–∏—Ç—Å—è */
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;

      background:
        radial-gradient(900px 700px at 18% 10%, rgba(10,74,138,.35) 0%, rgba(10,74,138,0) 55%),
        radial-gradient(900px 700px at 85% 85%, rgba(42,168,255,.18) 0%, rgba(42,168,255,0) 58%),
        linear-gradient(180deg, var(--bgDeep1), var(--bgDeep2));
    }

    /* –ü–æ–∫–∞ –ø—Ä–µ–ª–æ–∞–¥–µ—Ä ‚Äî –ø—Ä—è—á–µ–º —Å—Ç–æ—Ä–∏—Å */
    body.loading .shell{ opacity:0; pointer-events:none; }

    .stage{
      position:relative;
      width:100%;
      height:100%;
      display:grid;
      place-items:center;

      padding:
        max(14px, env(safe-area-inset-top))
        14px
        max(14px, env(safe-area-inset-bottom));
    }

    /* =====================================================================
       2) –•–õ–û–ü–¨–Ø –°–ù–ï–ì–ê
       ===================================================================== */
    .snow{
      position:absolute;
      inset:0;
      pointer-events:none;
      overflow:hidden;
    }
    .flake{
      position:absolute;
      top:-16vh;
      border-radius:999px;
      background: rgba(255,255,255,.90);
      box-shadow: 0 0 10px rgba(255,255,255,.20);
      filter: blur(var(--blur));
      opacity: var(--op);
      animation: fall var(--dur) linear infinite;
      transform: translate3d(0,0,0);
    }
    @keyframes fall{
      0%   { transform: translate3d(var(--x), -16vh, 0); }
      100% { transform: translate3d(calc(var(--x) + var(--drift)), 112vh, 0); }
    }

    /* =====================================================================
       3) –û–ë–û–õ–û–ß–ö–ê (–±–µ–ª—ã–π -> —Å–≤–µ—Ç–ª–æ-–≥–æ–ª—É–±–æ–π), –ø—Ä–æ–∑—Ä–∞—á–Ω–∞—è + blur
       ===================================================================== */
    .shell{
      position:relative;
      width:min(420px, 92vw);
      height:min(820px, 92vh);
      aspect-ratio: 9 / 16;
      border-radius: var(--shellRadius);
      overflow:hidden;

      background: linear-gradient(180deg,
        rgba(255,255,255,.92) 0%,
        rgba(240,250,255,.84) 55%,
        rgba(215,239,255,.78) 100%
      );

      border: 1px solid rgba(255,255,255,.55);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);

      box-shadow: 0 18px 52px rgba(0,0,0,.30);
      transition: opacity .2s ease;
    }

    /* =====================================================================
       4) –í–ù–£–¢–†–ï–ù–ù–ò–ô –ë–õ–û–ö (card)
       ===================================================================== */
    .card{
      position:absolute;
      inset: 18px 16px 18px;
      border-radius: var(--cardRadius);

      background: rgba(255,255,255,.92);
      border: 1px solid rgba(42,168,255,.10);
      box-shadow: 0 12px 34px rgba(0,0,0,.14);

      padding: var(--pad);
      padding-bottom: calc(var(--pad) + var(--footerH));

      display:flex;
      flex-direction:column;
      min-height:0; /* iOS —Ñ–∏–∫—Å */
    }

    .content{
      flex:1;
      display:flex;
      flex-direction:column;
      gap:12px;
      min-height:0;
      overflow:hidden; /* ‚úÖ –æ–±—â–∏–π —Å–∫—Ä–æ–ª–ª –∑–∞–ø—Ä–µ—â—ë–Ω */
    }

    /* =====================================================================
       5) –ï–î–ò–ù–´–ô –§–û–†–ú–ê–¢ ‚Äú–ü–ï–†–ï–õ–ò–í–ê–Æ–©–ï–ô–°–Ø –†–ê–ú–ö–ò‚Äù
       ===================================================================== */
    .frameLikeText{
      border: var(--borderW) solid transparent;
      background:
        linear-gradient(#fff,#fff) padding-box,
        linear-gradient(90deg,
          var(--blue),
          var(--blueDark),
          var(--blue),
          var(--blueDark),
          var(--blue)
        ) border-box;

      background-size: 100% 100%, 300% 100%;
      background-position: 0 0, 0% 50%;
      animation: shimmer var(--shimmerSpeed) ease-in-out infinite;
    }
    @keyframes shimmer{
      0%   { background-position: 0 0,   0% 50%; }
      50%  { background-position: 0 0, 100% 50%; }
      100% { background-position: 0 0,   0% 50%; }
    }

    /* =====================================================================
       6) HEADER (–∞–≤–∞—Ç–∞—Ä + –∏–º—è)
       ===================================================================== */
    .header{
      display:flex;
      align-items:center;
      gap:12px;
      min-height:62px;
    }

    .avatarWrap{
      width:62px;
      height:62px;
      position:relative;
      flex:0 0 auto;
      transform: translateZ(0);
    }

    /* –ö—Ä—É—Ç–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–±–æ–¥–æ–∫ */
    .ring{
      position:absolute;
      inset:0;
      border-radius:999px;
    }
    .ring::before{
      content:"";
      position:absolute;
      inset:0;
      border-radius:999px;
      padding: var(--ringPad);

      background: conic-gradient(
        from 0deg,
        rgba(42,168,255,.95),
        rgba(155,227,255,.95),
        rgba(255,255,255,.95),
        rgba(155,227,255,.95),
        rgba(42,168,255,.95)
      );
      animation: ringSpin 2.8s linear infinite;

      -webkit-mask: radial-gradient(circle, transparent calc(50% - var(--ringPad)), #000 calc(50% - var(--ringPad)));
              mask: radial-gradient(circle, transparent calc(50% - var(--ringPad)), #000 calc(50% - var(--ringPad)));
    }
    @keyframes ringSpin{ to{ transform: rotate(360deg);} }

    /* ‚úÖ –±–µ–ª–∞—è —Å–µ–π—Ñ-–∑–æ–Ω–∞ 1px –ø–æ—Å–ª–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ */
    .avatarSafe{
      position:absolute;
      inset: var(--ringPad);
      border-radius:999px;
      background:#fff;
      padding: var(--avatarSafeWhite);
      overflow:hidden;
    }
    .avatar{
      width:100%;
      height:100%;
      border-radius:999px;
      overflow:hidden;
      background: linear-gradient(145deg, rgba(155,227,255,.30), rgba(42,168,255,.10));
    }
    .avatar img{
      width:100%;
      height:100%;
      display:block;
      object-fit: cover;
    }

    .nameBox{
      min-width:0;
      display:flex;
      flex-direction:column;
      gap:4px;
      color: var(--ink);
    }
    .nameBox .label{
      font-size:11px;
      letter-spacing:.06em;
      text-transform:uppercase;
      color: rgba(17,50,74,.55);
    }
    .nameBox b{
      font-size:16px;
      line-height:1.2;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    /* =====================================================================
       7) –ü–†–û–ì–†–ï–°–°
       ===================================================================== */
    .topProgress{
      margin-top: 6px;
      margin-bottom: 6px;
    }
    .progress{
      display:flex;
      gap: var(--progressGap);
    }
    .seg{
      flex:1;
      height: var(--progressH);
      border-radius:999px;
      background: rgba(0,0,0,.06);
      overflow:hidden;
    }
    .fill{
      height:100%;
      width:0%;
      border-radius:999px;
      background: var(--blue);
    }

    /* =====================================================================
       8) –ü–û–ó–î–†–ê–í–õ–ï–ù–ò–ï (—Ç–æ–ª—å–∫–æ textOnly)
       ===================================================================== */
    .pill{
      border-radius:16px;
      padding:12px;
      overflow:hidden;

      display:flex;
      flex-direction:column;
      min-height:0;

      flex:1 1 auto; /* ‚úÖ –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö —Å–∂–∏–º–∞–µ—Ç—Å—è */
    }
    .pillLabel{
      font-size:11px;
      letter-spacing:.06em;
      text-transform:uppercase;
      color: rgba(17,50,74,.58);
      margin-bottom:6px;
      flex:0 0 auto;
    }
    .pillTextScroll{
      flex:1 1 auto;
      min-height:0;

      overflow:auto;
      -webkit-overflow-scrolling: touch; /* ‚úÖ iOS —Å–∫—Ä–æ–ª–ª */
      overscroll-behavior: contain;

      scrollbar-width:none;
      -ms-overflow-style:none;

      touch-action: pan-y; /* ‚úÖ –¥–∞—ë–º –ø–∞–ª—å—Ü—É —Å–∫—Ä–æ–ª–ª–∏—Ç—å */
    }
    .pillTextScroll::-webkit-scrollbar{ width:0; height:0; }
    .pillText{
      font-size:15px;
      line-height:1.38;
      white-space: pre-wrap;
      word-break: break-word;
      color: var(--ink);
      text-align:left;
    }

    /* =====================================================================
       9) –ö–ù–û–ü–ö–ê –ú–£–ó–´–ö–ò (—Ç–æ–ª—å–∫–æ –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–∏—Å)
       ===================================================================== */
    .musicBtn{
      display:none; /* –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ JS —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω—É–∂–Ω–æ–π —Å—Ç–æ—Ä–∏—Å */
      width:100%;
      border-radius:14px;
      padding:10px 12px;
      border:none;
      background: transparent;
      color: var(--ink);
      font-size:14px;
      line-height:1;
      cursor:pointer;

      align-items:center;
      justify-content:center;
      gap:8px;

      flex:0 0 auto;
    }
    .musicBtn:active{ transform: scale(0.99); }

    /* =====================================================================
       10) MEDIA (–∫–∞—Ä—Ç–∏–Ω–∫–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ 1 –∏ 9)
       ===================================================================== */
    .media{
      display:none; /* –≤–∫–ª—é—á–∞–µ–º –Ω–∞ imageOnly */
      border-radius:18px;
      overflow:hidden;
      padding: var(--mediaSafe);

      flex:1 1 auto;
      min-height:0;
    }
    .media img{
      width:100%;
      height:100%;
      display:block;
      object-fit: contain; /* ‚úÖ 1080√ó1920 –±–µ–∑ –æ–±—Ä–µ–∑–∫–∏ */
      background:#fff;
      border-radius: calc(18px - var(--mediaSafe));
    }

    /* =====================================================================
       11) FOOTER
       ===================================================================== */
    .footer{
      position:absolute;
      left: var(--pad);
      right: var(--pad);
      bottom: var(--pad);
      height: var(--footerH);

      display:flex;
      align-items:center;
      justify-content:space-between;

      color: rgba(17,50,74,.55);
      font-size:12px;
      pointer-events:none;
    }

    /* =====================================================================
       12) –†–ï–ñ–ò–ú–´ –°–¢–û–†–ò–°
       ===================================================================== */
    .mode-imageOnly .pill{ display:none; }
    .mode-imageOnly .musicBtn{ display:none; }
    .mode-imageOnly .media{ display:block; }
    .mode-textOnly .media{ display:none; }

    /* =====================================================================
       13) PRELOADER / SPINNER (–ø–æ–ª–æ–µ –∫–æ–ª—å—Ü–æ, —Ü–µ–Ω—Ç—Ä –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π)
       ===================================================================== */
    .preloader{
      position:fixed;
      inset:0;
      z-index:9999;

      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      gap:14px;

      background:
        radial-gradient(900px 700px at 18% 10%, rgba(10,74,138,.35) 0%, rgba(10,74,138,0) 55%),
        radial-gradient(900px 700px at 85% 85%, rgba(42,168,255,.18) 0%, rgba(42,168,255,0) 58%),
        linear-gradient(180deg, var(--bgDeep1), var(--bgDeep2));
    }
    .preloader.hidden{
      opacity:0;
      pointer-events:none;
      transition: opacity .25s ease;
    }
    .spinner{
      width:64px;
      height:64px;
      border-radius:999px;

      background: conic-gradient(
        from 0deg,
        rgba(42,168,255,.95),
        rgba(155,227,255,.95),
        rgba(255,255,255,.95),
        rgba(155,227,255,.95),
        rgba(42,168,255,.95)
      );

      -webkit-mask: radial-gradient(circle, transparent 58%, #000 59%);
              mask: radial-gradient(circle, transparent 58%, #000 59%);

      animation: spinLoader 1s linear infinite;
    }
    @keyframes spinLoader{ to{ transform: rotate(360deg); } }
    .preloaderText{
      font-size:13px;
      color: rgba(255,255,255,.75);
    }

    /* =====================================================================
       14) –ê–î–ê–ü–¢–ò–í (–æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–µ —ç–∫—Ä–∞–Ω—ã)
       ===================================================================== */
    @media (max-width: 380px){
      :root{ --pad: 14px; }
      .card{ inset: 14px 12px 12px; }
      .avatarWrap{ width:56px; height:56px; }
      .pillText{ font-size:14px; }
    }
    /* =====================================================================
       15) ‚úÖ –ü–µ—Ä–µ–ª–∏–≤–∞—é—â–∏–π—Å—è "–Ω–µ–æ–Ω–æ–≤—ã–π" —Ç–µ–∫—Å—Ç (—Ä–æ–∑–æ–≤–æ-–∫—Ä–∞—Å–Ω–∞—è –ø–∞–ª–∏—Ç—Ä–∞ –∫–∞–∫ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ)
       ===================================================================== */
.shimmerTextNeon{
  display:inline-block;

  background: linear-gradient(
    90deg,
    #F40C83,
    #D9026A,
    #F6244C,
    #F5102B,
    #E83F68,
    #F675B3,
    #F40C83
  );
  background-size: 350% 100%;
  background-position: 0% 50%;

  -webkit-background-clip: text;
  background-clip: text;

  color: transparent !important;
  -webkit-text-fill-color: transparent; /* ‚úÖ Safari/iOS —Ñ–∏–∫—Å */

  animation: shimmerTextNeon 2.2s ease-in-out infinite;
}

@keyframes shimmerTextNeon{
  0%   { background-position: 0% 50%; }
  50%  { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

    /* =====================================================================
       16) ‚úÖ –ü–µ—Ä–µ–ª–∏–≤–∞—é—â–∏–π—Å—è "–Ω–µ–æ–Ω–æ–≤—ã–π" —Ç–µ–∫—Å—Ç (–≥–æ–ª—É–±–æ–π –≥—Ä–∞–¥–∏–µ–Ω—Ç)
       ===================================================================== */
.shimmerTextBlue{
  display:inline-block;

  background: linear-gradient(
    90deg,
    #0c71f4,
    #8004e6,
    #186dee,
    #6dadf7,
    #4bc0f7,
    #557cc4,
    #2105be
  );
  background-size: 350% 100%;
  background-position: 0% 50%;

  -webkit-background-clip: text;
  background-clip: text;

  color: transparent !important;
  -webkit-text-fill-color: transparent; /* ‚úÖ Safari/iOS —Ñ–∏–∫—Å */

  animation: shimmerTextBlue 4.2s ease-in-out infinite;
}

@keyframes shimmerTextBlue{
  0%   { background-position: 0% 50%; }
  50%  { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
  </style>
</head>

<body class="loading">
  <!-- ===================== PRELOADER ===================== -->
  <div class="preloader" id="preloader" aria-label="–í–æ–ª—à–µ–±—Å—Ç–≤–æ —É–∂–µ –±–ª–∏–∑–∫–æ">
    <div class="spinner" aria-hidden="true"></div>
    <div class="preloaderText">–í–æ–ª—à–µ–±—Å—Ç–≤–æ —É–∂–µ –±–ª–∏–∑–∫–æ</div>
  </div>

  <div class="stage" id="stage">
    <div class="snow" id="snow"></div>

    <div class="shell">
      <div class="card" id="card">
        <div class="content">
          <!-- HEADER: –≤–∏–¥–µ–Ω –≤—Å–µ–≥–¥–∞ -->
          <div class="header">
            <div class="avatarWrap" aria-hidden="true">
              <div class="ring"></div>
              <div class="avatarSafe">
                <div class="avatar">
                  <img id="avatarImg" alt="avatar" src="" />
                </div>
              </div>
            </div>

            <div class="nameBox">
              <div class="label" id="nameLabel">–ò–ú–Ø</div>
              <b id="nameValue">–ò–≤–∞–Ω</b>
            </div>
          </div>

          <!-- PROGRESS -->
          <div class="topProgress">
            <div class="progress" id="progress"></div>
          </div>

          <!-- –ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ textOnly) -->
          <div class="pill frameLikeText" id="pill">
            <div class="pillLabel" id="greetLabel">–ü–û–ó–î–†–ê–í–õ–ï–ù–ò–ï</div>
            <div class="pillTextScroll" id="pillScroll">
              <div class="pillText" id="greetText"></div>
            </div>
          </div>

          <!-- –ö–Ω–æ–ø–∫–∞ –º—É–∑—ã–∫–∏ (—Ç–æ–ª—å–∫–æ –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–∏—Å) -->
          <button class="musicBtn frameLikeText" id="musicBtn" type="button" aria-label="–ú—É–∑—ã–∫–∞">
            <span id="musicBtnText">‚ñ∂ –ß–∏—Ç–∞—Ç—å –ø–æ–¥ –º—É–∑—ã–∫—É</span>
          </button>

          <!-- –ö–∞—Ä—Ç–∏–Ω–∫–∞ (—Ç–æ–ª—å–∫–æ 1 –∏ 9) -->
          <div class="media frameLikeText" id="media"></div>
        </div>

        <div class="footer">
          <span id="counter">1 / 9</span>
          <span>–¢–∞–ø —Å–ª–µ–≤–∞/—Å–ø—Ä–∞–≤–∞ ‚Ä¢ –°–≤–∞–π–ø</span>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚úÖ –ú—É–∑—ã–∫–∞: loop = –ø–æ–≤—Ç–æ—Ä.
       –°—Å—ã–ª–∫—É –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –≤ JS –∏–∑ stories[].musicUrl -->
  <audio id="bgMusic" preload="auto" loop>
    <source id="bgMusicSrc" src="" type="audio/mpeg" />
  </audio>

  <script>
    /* =====================================================================
       1) –ó–∞–ø—Ä–µ—Ç –∑—É–º–∞ (best-effort)
       ===================================================================== */
    window.addEventListener('wheel', (e) => { if (e.ctrlKey || e.metaKey) e.preventDefault(); }, { passive:false });
    window.addEventListener('gesturestart', (e) => e.preventDefault());
    window.addEventListener('gesturechange', (e) => e.preventDefault());
    window.addEventListener('gestureend', (e) => e.preventDefault());

    /* =====================================================================
       2) –°–¢–û–†–ò–° ‚Äî –ü–†–ê–í–ò–¢–¨ –¢–£–¢
       ===================================================================== */
 const stories = [
      {
        type: "textOnly",
        nameLabel: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å",
        nameValue: "–ú–æ–¥–µ—Ä–∏—Ä—É–µ–º 2.0",
        greetLabel: "–ú—ã –≤–µ—Ä–Ω—É–ª–∏—Å—å :)",
        greetHTML: `–í—ã –≤–æ–∑–º–æ–∂–Ω–æ –∏ –Ω–µ –∑–Ω–∞–µ—Ç–µ —á—Ç–æ —Ç–∞–∫–æ–µ <span class="shimmerTextBlue"><strong>"–ú–æ–¥–µ—Ä–∏—Ä—É–µ–º 2.0"</strong></span>, –≤–µ–¥—å –ø–æ—Å–ª–µ–¥–Ω–∏–º –≤—ã–ø—É—Å–∫–æ–º –±—ã–ª –ø—Ä–æ—à–ª–æ–≥–æ–¥–Ω–∏–π —Ä–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–π —Å–ø—ç—à–∞–ª, –Ω–æ —Ç–µ–ø–µ—Ä—å –∑–Ω–∞–π—Ç–µ –º—ã —Ç—É—Ç —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ–º –æ –Ω–∞—à–µ–π –∂–∏–∑–Ω–∏, –∞ –∞—Ä—Ö–∏–≤—ã –¥–æ —Å–∏—Ö —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ñ–∞–π–ª–∞—Ö —á–∞—Ç–∏–∫–∞. 
        <br>–ù–æ —Ç–µ–ø–µ—Ä—å –Ω–∞—Å—Ç–∞–ª–æ –≤—Ä–µ–º—è <strong>–≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –Ω–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ</strong> –∏ –ø–æ–∂–µ–ª–∞—Ç—å –≤—Å–µ–º –≤–∞–º <span class="shimmerTextNeon"><strong>–ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–≥–æ –ù–æ–≤–æ–≥–æ –≥–æ–¥–∞.</strong></span> –õ–∏—Å—Ç–∞–π—Ç–µ –∫–∞–∫ –æ–±—ã—á–Ω—ã–µ —Å—Ç–æ—Ä–∏—Å —Ç–∞–ø–∞–º–∏ –∏–ª–∏ —Å–≤–∞–π–ø–∞–º–∏ —Å–ª–µ–≤–∞ –Ω–∞ –ø—Ä–∞–≤–æ –∏ –Ω–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –≤–∞—à–∏–º–∏ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏ –¥—Ä—É–≥ –¥—Ä—É–≥—É, –∞ –µ—â–µ –º–æ–∂–µ—Ç–µ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ–¥ –º—É–∑—ã–∫—É - –ø—Ä–æ—Å—Ç–æ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ`,
        avatarUrl: "https://raw.githubusercontent.com/alexeeffnsa/secretimages/refs/heads/main/special/logo.jpg",
        hasMusic: true,
        musicUrl: "https://raw.githubusercontent.com/alexeeffnsa/secretimages/refs/heads/main/special/hny.mp3" /* üëà –≤—Å—Ç–∞–≤—å –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É –Ω–∞ mp3 */
      },

      {
        type: "textOnly",
        nameLabel: "–û—Ç –∫–æ–≥–æ",
        nameValue: "–Æ—Ä–∞",
        greetLabel: "–ö–æ–º—É: –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã",
        greetHTML: '–•–æ—á—É –ø–æ–∑–¥—Ä–∞–≤–∏—Ç—å —Å –ù–æ–≤—ã–º –≥–æ–¥–æ–º <span class="shimmerTextNeon">—Å–∞–º—É—é –ª—É—á—à—É—é –∫–æ–º–∞–Ω–¥—É –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤.</span><br>–ò —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–ª–æ–≤–∞, —è –ø—Ä–∞–≤–¥–∞ —É–≤–µ—Ä–µ–Ω, —á—Ç–æ —Ç–µ–∫—É—â–∏–π —Å–æ—Å—Ç–∞–≤ –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö —Å–∏–ª—å–Ω—ã—Ö! –ö–∞–∂–¥—ã–π –∏–∑ –≤–∞—Å –ø–æ-—Å–≤–æ–µ–º—É —É–Ω–∏–∫–∞–ª–µ–Ω, –∏ –∏–º–µ–Ω–Ω–æ –≤ —ç—Ç–æ–º –≤–∞—à–∞ —Å–∏–ª–∞! –° –ø–µ—Ä–≤—ã—Ö –¥–Ω–µ–π —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã —è –Ω–∞–±–ª—é–¥–∞–ª, –∫–∞–∫ –æ–Ω–∞ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è, –ø–æ—Å–ª–µ–¥–Ω–∏–π –≥–æ–¥ —è —Å—Ç–∞—Ä–∞–ª—Å—è –¥–µ–ª–∞—Ç—å –≤—Å—ë –≤–æ–∑–º–æ–∂–Ω–æ–µ, —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å –ª–∏—à–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∏ —Å–¥–µ–ª–∞—Ç—å –≤–∞—à—É —Ä–∞–±–æ—Ç—É –∫–æ–º—Ñ–æ—Ä—Ç–Ω–µ–π, –∏ —è —Ü–µ–Ω—é, —á—Ç–æ –≤—ã –º–µ–Ω—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª–∏ –≤ —ç—Ç–æ–º –∏ –ø—Ä–∏—Å–ª—É—à–∏–≤–∞–ª–∏—Å—å, —Å–ø–∞—Å–∏–±–æ –≤–∞–º –∑–∞ —ç—Ç–æ! –õ–∏–∑–∞, –°–∞—à–∞, –ù–∞—Å—Ç—è, –ñ–µ–Ω—è, –≤—ã –æ—á–µ–Ω—å –∫—Ä—É—Ç—ã–µ, –∏ —è –æ—á–µ–Ω—å –Ω–∞–¥–µ—é—Å—å, —á—Ç–æ –≤ —ç—Ç–æ–º –≥–æ–¥—É –≤—ã —Å–º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ —Å–≤–æ–∏ –º–µ—á—Ç—ã –∏ –Ω–∞–π—Ç–∏ —Å–≤–æ—ë —Å—á–∞—Å—Ç—å–µ, —É–ª—ã–±–∫–∞ –Ω–∞ –≤–∞—à–∏—Ö –ª–∏—Ü–∞—Ö ‚Äî —ç—Ç–æ –≥–ª–∞–≤–Ω–æ–µ —É–∫—Ä–∞—à–µ–Ω–∏–µ, —Ç–∞–∫ –ø—É—Å—Ç—å –≤ –Ω–æ–≤–æ–º –≥–æ–¥—É –æ–Ω–∞ –Ω–µ —Å—Ö–æ–¥–∏—Ç —Å –≤–∞—à–µ–≥–æ –ª–∏—Ü–∞! <span class="shimmerTextNeon">C –Ω–æ–≤—ã–º 2026 –≥–æ–¥–æ–º, –¥–æ—Ä–æ–≥–∏–µ –¥—Ä—É–∑—å—è :)))</span>',
        avatarUrl: "https://raw.githubusercontent.com/alexeeffnsa/secretimages/refs/heads/main/special/yura.jpg"
      },
      {
        type: "textOnly",
        nameLabel: "–û—Ç –∫–æ–≥–æ",
        nameValue: "–î–∞—à–∞",
        greetLabel: "–Ø—Ä–∫–∏—Ö –º–æ–º–µ–Ω—Ç–æ–≤",
        greetHTML: '–î–æ—Ä–æ–≥–∏–µ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã! –ü–æ–∑–¥—Ä–∞–≤–ª—è—é –∫–∞–∂–¥–æ–≥–æ –∏–∑ –≤–∞—Å —Å –ù–æ–≤—ã–º –ì–æ–¥–æ–º –∏ –Ω–∞–¥–µ—é—Å—å, —á—Ç–æ –≤—ã –≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ –µ–≥–æ –ø—Ä–æ–≤–æ–¥–∏—Ç–µüå≤–ñ–µ–ª–∞—é, —á—Ç–æ–±—ã –≤ —Å–ª–µ–¥—É—é—â–µ–º –≥–æ–¥—É –≤ —á–∞—Ç–∞—Ö –±—ã–ª–æ –º–µ–Ω—å—à–µ –ø–æ–∂–∞—Ä–æ–≤ –∏ –±–æ–º–±–∞—Ä–¥–∏—Ä–æ–≤–æ–∫, –∞ –≤ –≤–∞—à–µ–π –ª–∏—á–Ω–æ–π –∂–∏–∑–Ω–∏ –±—ã–ª–æ –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –ø—Ä–∏—è—Ç–Ω—ã—Ö –∏ –∑–∞–ø–æ–º–∏–Ω–∞—é—â–∏—Ö—Å—è –º–æ–º–µ–Ω—Ç–æ–≤! –ë–µ—Ä–µ–≥–∏—Ç–µ —Å–µ–±—è –∏ —Å–ø–∞—Å–∏–±–æ –∑–∞ —Ç–æ, —á—Ç–æ –≤—ã —Å –Ω–∞–º–∏ üíô',
        avatarUrl: "https://raw.githubusercontent.com/alexeeffnsa/secretimages/refs/heads/main/special/zglsh.jpg"
      },
      {
        type: "textOnly",
        nameLabel: "–û—Ç –∫–æ–≥–æ",
        nameValue: "–ï–ª–∏–∑–∞–≤–µ—Ç–∞",
        greetLabel: "–ó–¥–æ—Ä–æ–≤—å—è –∏ —Ä–∞–¥–æ—Å—Ç–∏",
        greetHTML: '–î–æ—Ä–æ–≥–∏–µ –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã, —Å –ù–æ–≤—ã–º –≥–æ–¥–æ–º! üéÑ –û—Ç –≤—Å–µ–π –¥—É—à–∏ –∂–µ–ª–∞—é –≤–∞–º –∑–¥–æ—Ä–æ–≤—å—è ‚Äî —Å–∞–º–æ–≥–æ –≥–ª–∞–≤–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞. –ò –ø—É—Å—Ç—å –Ω–æ–≤—ã–π –≥–æ–¥ –±—É–¥–µ—Ç –¥–ª—è –≤–∞—Å —Å—Ç–∞–±–∏–ª—å–Ω—ã–º –∏ —â–µ–¥—Ä—ã–º ‚Äî —á—Ç–æ–±—ã –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –ø–µ—Ä–µ–∂–∏–≤–∞—Ç—å –æ –≤–∞–∂–Ω–æ–º –∏ –æ—Å—Ç–∞–≤–∞–ª–æ—Å—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è —Ä–∞–¥–æ—Å—Ç–∏. –°–ø–∞—Å–∏–±–æ –∫–∞–∂–¥–æ–º—É, —á—Ç–æ –≤—ã –µ—Å—Ç—å –≤ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–µ. –ë—É–¥–µ–º –∏ –¥–∞–ª—å—à–µ –¥–µ—Ä–∂–∞—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –≤ —Ç–æ–Ω—É—Å–µ –∏ –≤ —Ç–µ–ø–ª–µ. –ï—â—ë —Ä–∞–∑ —Å –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º!‚òÉÔ∏è',
        avatarUrl: "https://raw.githubusercontent.com/alexeeffnsa/secretimages/refs/heads/main/special/liza.jpg"
      },
      {
        type: "textOnly",
        nameLabel: "–û—Ç –∫–æ–≥–æ",
        nameValue: "–°–∞—à–∞",
        greetLabel: "–Ø—Ä–∫–∏—Ö –º–æ–º–µ–Ω—Ç–æ–≤",
        greetHTML: '–ü—É—Å—Ç—å –≥–æ–¥ –±—É–¥–µ—Ç —â–µ–¥—Ä—ã–º –Ω–∞ —Ö–æ—Ä–æ—à–∏–µ —Å–æ–±—ã—Ç–∏—è: –Ω–æ–≤—ã–µ –∏–¥–µ–∏, –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –∏ –º–∞–ª–µ–Ω—å–∫–∏–µ —Ä–∞–¥–æ—Å—Ç–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å. üéÅ –∏ –±–ª–∞–±–ª–∞–±–ª–∞ –µ—â–µ –º–Ω–æ–≥–æ –±–ª–∞–±–ª–∞ –±–ª–∞ –∏ –µ—â–µ –±–æ–ª—å—à–µ –±–ª–∞ –±–ª–∞',
        avatarUrl: "https://raw.githubusercontent.com/alexeeffnsa/secretimages/refs/heads/main/special/sasha.jpg"
      },
      {
        type: "textOnly",
        nameLabel: "–ò—Ç–æ–≥–∏",
        nameValue: "stickers",
        greetLabel: "–ò—Ç–æ–≥–∏ –≥–æ–¥–∞",
        greetHTML: '–í–Ω–µ–∑–∞–ø–Ω–æ –≤—Ä—ã–≤–∞–µ–∏—Å—è ‚ú® –•–æ–¥—è—Ç —Å–ª—É—Ö–∏ —á—Ç–æ –Ω–µ–∫–∏–µ —Å—Ç–∏–∫–µ—Ä—ã —Å—Ç–∞–ª–∏ –Ω–µ–æ—Ç—ä–µ–º–ª–µ–º–æ–π —á–∞—Å—Ç—å—é –∫–æ–º—å—é–Ω–∏—Ç–∏ –õ–∞–≤–∫–∏, –∫–∞–∫ –∏ —ç–º–æ–¥–∑–∏, –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥—è –Ω–æ–≤—ã—Ö –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, –≤–ø—Ä–æ—á–µ–º –∫–∞–∫ –∏ —Å–∞–º–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–∫—Ä–µ–ø–ª—ë–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç–∞—Ö. –í—ã—Ä–æ—Å—à–∏–µ –∏–∑ –æ–¥–Ω–æ–≥–æ –º–∞–ª–µ–Ω—å–∫–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –æ–Ω–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ —Å–æ–≤—Å–µ–º –Ω–µ–æ–±—ã—á–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö :). –ù–æ –¥–∞–≤–∞–π—Ç–µ –æ–± –∏—Ç–æ–≥–∞—Ö: –∑–∞ 2025 –≥–æ–¥ –º—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Å—Ç—Ä–æ–∏–ª–∏ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç–∞—Ö —Å –ú–æ—Å–∫–≤–æ–π –∏ –ø–µ—Ä–µ–Ω–µ—Å–ª–∏ –∏—Ö –≤ —á–∞—Ç—ã —Å –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–æ–º, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–≤ –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –∏ –¥–∞–∂–µ –ø–æ—è–≤–∏–ª–∏—Å—å –≤ –ò—Ä–∫—É—Ç—Å–∫–µ :) –¢–µ–º –≤—Ä–µ–º–µ–Ω–µ–º —Å—Ç–∏–∫–µ—Ä—ã –±—ã–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã 30520 —Ä–∞–∑ –∑–∞ 2025-–π –≥–æ–¥, –∞ —Å—Ç–∏–∫–µ—Ä ¬´–ß–∏—Ç–∞–π –∑–∞–∫—Ä–µ–ø—ã¬ª –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω 324 —Ä–∞–∑–∞, –Ω–µ —Å—á–∏—Ç–∞—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞. –í–æ—Ç —Ç–∞–∫–∏–µ –º–∏–Ω–∏ –∏—Ç–æ–≥–∏ :) –°—á–∞—Å—Ç–ª–∏–≤–æ–≥–æ –ù–æ–≤–æ–≥–æ –≥–æ–¥–∞ –∏ –¥–∞ –ø—Ä–∏–±—É–¥–µ—Ç —Å –≤–∞–º–∏ —Å–∏–ª–∞!',
        avatarUrl: "https://raw.githubusercontent.com/alexeeffnsa/secretimages/refs/heads/main/special/FDC-team3.jpg"
      },
      {
        type: "textOnly",
        nameLabel: "–ò–ú–Ø",
        nameValue: "–í–∏–∫—Ç–æ—Ä–∏—è",
        greetLabel: "–ü–û–ó–î–†–ê–í–õ–ï–ù–ò–ï",
        greetHTML: `
        –° –ù–æ–≤—ã–º –≥–æ–¥–æ–º! 
        <span class="shimmerTextNeon">–ü—É—Å—Ç—å –º–µ—á—Ç—ã —Å–±—ã–≤–∞—é—Ç—Å—è</span> ‚ú®
        `,
        avatarUrl: "PASTE_AVATAR_URL_FOR_STORY_8_HERE"
      },

      {
        type: "imageOnly",
        nameLabel: "–ù–µ–±–æ–ª—å—à–æ–π —Å—é—Ä–ø—Ä–∏–∑",
        nameValue: "–ú–æ–¥–µ—Ä–∏—Ä—É–µ–º 2.0",
        avatarUrl: "PASTE_AVATAR_URL_FOR_STORY_9_HERE",
        mediaUrl:  "PASTE_IMAGE_URL_1080x1920_FOR_STORY_9_HERE"
      }
    ];

    /* =====================================================================
       3) –¢–∞–π–º–∏–Ω–≥ —Å—Ç–æ—Ä–∏—Å
       ===================================================================== */
    const STORY_MS = 90000;

    /* =====================================================================
       4) DOM
       ===================================================================== */
    const preloaderEl = document.getElementById("preloader");
    const stage = document.getElementById("stage");
    const card  = document.getElementById("card");

    const progressEl  = document.getElementById("progress");
    const counterEl   = document.getElementById("counter");

    const avatarImg   = document.getElementById("avatarImg");
    const nameLabelEl = document.getElementById("nameLabel");
    const nameValueEl = document.getElementById("nameValue");

    const greetLabelEl= document.getElementById("greetLabel");
    const greetTextEl = document.getElementById("greetText");
    const pillScroll  = document.getElementById("pillScroll");

    const mediaEl     = document.getElementById("media");

    const musicBtn    = document.getElementById("musicBtn");
    const musicBtnText= document.getElementById("musicBtnText");

    const bgMusic     = document.getElementById("bgMusic");
    const bgMusicSrc  = document.getElementById("bgMusicSrc");
    bgMusic.loop = true; // ‚úÖ –ø–æ–≤—Ç–æ—Ä

    /* =====================================================================
       5) –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–µ–≥–º–µ–Ω—Ç—ã
       ===================================================================== */
    const fills = [];
    for (let i=0;i<stories.length;i++){
      const seg = document.createElement("div");
      seg.className = "seg";
      const fill = document.createElement("div");
      fill.className = "fill";
      seg.appendChild(fill);
      progressEl.appendChild(seg);
      fills.push(fill);
    }

    /* =====================================================================
       6) –ó–∞–≥–ª—É—à–∫–∏
       ===================================================================== */
    function isPlaceholder(url){
      return !url || String(url).startsWith("PASTE_");
    }

    function svgDataUri(title, subtitle){
      const svg = `
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 720 1280">
  <defs>
    <linearGradient id="g" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="#eaf7ff"/>
      <stop offset="1" stop-color="#ffffff"/>
    </linearGradient>
  </defs>
  <rect width="720" height="1280" fill="url(#g)"/>
  <text x="50%" y="54%" text-anchor="middle"
        font-family="system-ui, -apple-system, Segoe UI, Roboto, Arial"
        font-size="38" fill="#11324a" fill-opacity=".75">${title}</text>
  <text x="50%" y="60%" text-anchor="middle"
        font-family="system-ui, -apple-system, Segoe UI, Roboto, Arial"
        font-size="20" fill="#11324a" fill-opacity=".55">${subtitle}</text>
</svg>`;
      return "data:image/svg+xml;charset=utf-8," + encodeURIComponent(svg.trim());
    }

    /* =====================================================================
       7) –°–¢–û–†–ò–°-–õ–û–ì–ò–ö–ê
       ===================================================================== */
    let idx = 0;
    let startTs = performance.now();
    let raf = null;

    function clamp(i){
      const n = stories.length;
      return (i % n + n) % n;
    }

    function applyMode(story){
      card.classList.toggle("mode-imageOnly", story.type === "imageOnly");
      card.classList.toggle("mode-textOnly",  story.type === "textOnly");
    }

    function setProgressBase(){
      fills.forEach((f, i) => { f.style.width = (i < idx) ? "100%" : "0%"; });
    }

    function renderAvatar(story, index){
      const src = (!isPlaceholder(story.avatarUrl))
        ? story.avatarUrl
        : svgDataUri("AVATAR", `–≤—Å—Ç–∞–≤—å avatarUrl –¥–ª—è —Å—Ç–æ—Ä–∏—Å #${index+1}`);
      avatarImg.src = src;
    }

    function renderMedia(story, index){
      mediaEl.innerHTML = "";
      if (story.type !== "imageOnly") return;

      const src = (!isPlaceholder(story.mediaUrl))
        ? story.mediaUrl
        : svgDataUri("IMAGE 1080√ó1920", `–≤—Å—Ç–∞–≤—å mediaUrl –¥–ª—è —Å—Ç–æ—Ä–∏—Å #${index+1}`);

      const img = document.createElement("img");
      img.alt = "story image";
      img.src = src;
      mediaEl.appendChild(img);
    }

    /* ===================== –ú–£–ó–´–ö–ê =====================
       ‚úÖ –ú—É–∑—ã–∫–∞ –ù–ï –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–ª–∏—Å—Ç—ã–≤–∞–Ω–∏–∏.
       ‚úÖ –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–∏—Å.
       ‚úÖ –ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –ù–ï –ø–µ—Ä–µ–ª–∏—Å—Ç—ã–≤–∞–µ—Ç —Å—Ç–æ—Ä–∏—Å (—Å–º. –±–ª–æ–∫ stopPropagation –Ω–∏–∂–µ).
    */
    let musicOn = false;
    let currentMusicUrl = "";

    function renderMusic(story){
      const has = !!(story.hasMusic && story.musicUrl && !isPlaceholder(story.musicUrl));

      if (has){
        musicBtn.style.display = "flex";

        if (currentMusicUrl !== story.musicUrl){
          currentMusicUrl = story.musicUrl;
          bgMusicSrc.src = story.musicUrl;
          bgMusic.load();
        }

        musicBtnText.textContent = (!bgMusic.paused && musicOn) ? "–ü–∞—É–∑–∞" : "‚ñ∂ –ß–∏—Ç–∞—Ç—å –ø–æ–¥ –º—É–∑—ã–∫—É";
      } else {
        musicBtn.style.display = "none";
      }
    }

    function render(){
      const s = stories[idx];

      applyMode(s);

      /* ‚úÖ –ò–º—è –æ–±–Ω–æ–≤–ª—è–µ–º –í–°–ï–ì–î–ê (—á—Ç–æ–±—ã –Ω–µ ‚Äú–∫—ç—à–∏—Ä–æ–≤–∞–ª–æ—Å—å‚Äù) */
      nameLabelEl.textContent = s.nameLabel ?? "–ò–ú–Ø";
      nameValueEl.textContent = s.nameValue ?? "";

      /* –¢–µ–∫—Å—Ç –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è textOnly */
      if (s.type === "textOnly"){
        greetLabelEl.textContent = s.greetLabel ?? "–ü–û–ó–î–†–ê–í–õ–ï–ù–ò–ï";
        greetTextEl.innerHTML  = s.greetHTML  ?? "";
        pillScroll.scrollTop = 0;
      } else {
        greetLabelEl.textContent = "";
        greetTextEl.innerHTML = s.greetHTML ?? (s.greetText ?? "");
      }

      renderAvatar(s, idx);
      renderMedia(s, idx);
      renderMusic(s);

      counterEl.textContent = `${idx + 1} / ${stories.length}`;

      setProgressBase();
      startTs = performance.now();
      tick();
    }

    function next(){ idx = clamp(idx + 1); render(); }
    function prev(){ idx = clamp(idx - 1); render(); }

    function tick(){
      if (raf) cancelAnimationFrame(raf);

      const loop = (t) => {
        const p = Math.min(1, (t - startTs) / STORY_MS);
        fills[idx].style.width = (p * 100).toFixed(2) + "%";
        if (p >= 1) { next(); return; }
        raf = requestAnimationFrame(loop);
      };
      raf = requestAnimationFrame(loop);
    }

    /* =====================================================================
       8) –¢–ê–ü–´ + –°–í–ê–ô–ü–´ –ü–û –í–°–ï–ú–£ –≠–ö–†–ê–ù–£
       - –∑–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω–æ–≥–æ –ø–µ—Ä–µ–ª–∏—Å—Ç—ã–≤–∞–Ω–∏—è
       - –Ω–µ –º–µ—à–∞–µ–º —Å–∫—Ä–æ–ª–ª—É —Ç–µ–∫—Å—Ç–∞
       - –ù–ï –ª–∏—Å—Ç–∞–µ–º –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –º—É–∑—ã–∫–∏
       ===================================================================== */
    const TAP_MOVE_THRESHOLD = 10;
    const SWIPE_THRESHOLD = 40;
    const SWIPE_Y_LIMIT = 60;

    let startX=0, startY=0;
    let startedInTextScroll=false;
    let navLockUntil=0;

    function canNav(){ return performance.now() >= navLockUntil; }
    function lockNav(){ navLockUntil = performance.now() + 260; }

    stage.addEventListener("pointerdown", (e)=>{
      startX = e.clientX;
      startY = e.clientY;
      startedInTextScroll = !!e.target.closest("#pillScroll");
    }, {passive:true});

    stage.addEventListener("pointerup", (e)=>{
      /* ‚úÖ –ï—Å–ª–∏ —Ç–∞–ø/–∂–µ—Å—Ç –ø–æ –∫–Ω–æ–ø–∫–µ –º—É–∑—ã–∫–∏ ‚Äî –Ω–µ –Ω–∞–≤–∏–≥–∏—Ä—É–µ–º */
      if (e.target.closest("#musicBtn")) return;

      const dx = e.clientX - startX;
      const dy = e.clientY - startY;

      if (startedInTextScroll && Math.abs(dy) > Math.abs(dx) && Math.abs(dy) > TAP_MOVE_THRESHOLD){
        return; // —ç—Ç–æ —Å–∫—Ä–æ–ª–ª —Ç–µ–∫—Å—Ç–∞
      }

      if (Math.abs(dx) >= SWIPE_THRESHOLD && Math.abs(dy) <= SWIPE_Y_LIMIT){
        if (!canNav()) return;
        lockNav();
        if (dx < 0) next(); else prev();
        return;
      }

      if (Math.abs(dx) <= TAP_MOVE_THRESHOLD && Math.abs(dy) <= TAP_MOVE_THRESHOLD){
        if (!canNav()) return;
        lockNav();

        const mid = window.innerWidth / 2;
        if (e.clientX < mid) prev();
        else next();
      }
    }, {passive:true});

    /* ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞: –Ω–µ –¥–∞—ë–º –∫–Ω–æ–ø–∫–µ ‚Äú–≤—Å–ø–ª—ã—Ç—å‚Äù –¥–æ stage */
    ["pointerdown","pointerup","click"].forEach(evt=>{
      musicBtn.addEventListener(evt, (e)=> e.stopPropagation());
    });

    /* =====================================================================
       9) –ö–ù–û–ü–ö–ê –ú–£–ó–´–ö–ò
       ===================================================================== */
    musicBtn.addEventListener("click", async () => {
      try{
        if (bgMusic.paused){
          await bgMusic.play();  // iOS —Ä–∞–∑—Ä–µ—à–∏—Ç —Ç–æ–ª—å–∫–æ –ø–æ –∫–ª–∏–∫—É
          musicOn = true;
          musicBtnText.textContent = "–ü–∞—É–∑–∞";
        } else {
          bgMusic.pause();
          musicOn = false;
          musicBtnText.textContent = "‚ñ∂ –ß–∏—Ç–∞—Ç—å –ø–æ–¥ –º—É–∑—ã–∫—É";
        }
      } catch(err){
        console.log("Music play blocked:", err);
        musicBtnText.textContent = "‚ñ∂ –ù–∞–∂–º–∏ –µ—â—ë —Ä–∞–∑";
      }
    });

    /* =====================================================================
       10) –•–ª–æ–ø—å—è —Å–Ω–µ–≥–∞
       ===================================================================== */
    const snow = document.getElementById("snow");
    const rand = (a,b)=>Math.random()*(b-a)+a;

    const FLAKES = 90;
    for (let i=0;i<FLAKES;i++){
      const el = document.createElement("div");
      el.className = "flake";

      const size = rand(3, 10);
      const dur  = rand(8, 18);
      const x    = rand(-5, 105);
      const drift= rand(-30, 30);
      const delay= rand(-18, 0);
      const op   = rand(0.25, 0.85);
      const blur = rand(0, 1.4);

      el.style.width = size + "px";
      el.style.height = size + "px";
      el.style.setProperty("--dur", dur + "s");
      el.style.setProperty("--x", x + "vw");
      el.style.setProperty("--drift", drift + "px");
      el.style.animationDelay = delay + "s";
      el.style.setProperty("--op", op.toFixed(2));
      el.style.setProperty("--blur", blur.toFixed(2) + "px");

      snow.appendChild(el);
    }

    /* =====================================================================
       11) –ü–†–ï–î–ó–ê–ì–†–£–ó–ö–ê –ö–ê–†–¢–ò–ù–û–ö + –ó–ê–î–ï–†–ñ–ö–ê 10–° (—Ç–µ—Å—Ç)
       - –ß—Ç–æ–±—ã —É–±—Ä–∞—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É: MIN_SPINNER_MS = 0
       ===================================================================== */
    function collectUrls(){
      const urls = [];
      for (const s of stories){
        if (s.avatarUrl && !isPlaceholder(s.avatarUrl)) urls.push(s.avatarUrl);
        if (s.mediaUrl  && !isPlaceholder(s.mediaUrl))  urls.push(s.mediaUrl);
      }
      return Array.from(new Set(urls));
    }

    function preloadImage(url){
      return new Promise((resolve)=>{
        const img = new Image();
        img.onload  = () => resolve(true);
        img.onerror = () => resolve(false);
        img.src = url;
      });
    }

    async function waitReady(){
      if (document.readyState !== "complete" && document.readyState !== "interactive"){
        await new Promise(r => document.addEventListener("DOMContentLoaded", r, { once:true }));
      }
      const urls = collectUrls();
      if (urls.length) await Promise.all(urls.map(preloadImage));
      if (document.fonts && document.fonts.ready){
        try{ await document.fonts.ready; }catch(e){}
      }
    }

    (async ()=>{
      const MIN_SPINNER_MS = 10000; // ‚úÖ —Ç–µ—Å—Ç–æ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞. –ü–æ—Å—Ç–∞–≤—å 0 ‚Äî —É–±–µ—Ä—ë—à—å.
      const start = performance.now();

      await waitReady();

      const remain = Math.max(0, MIN_SPINNER_MS - (performance.now() - start));
      if (remain) await new Promise(r=>setTimeout(r, remain));

      document.body.classList.remove("loading");
      preloaderEl.classList.add("hidden");
      setTimeout(()=>preloaderEl.remove(), 300);

      render();
    })();
  </script>
</body>
</html>